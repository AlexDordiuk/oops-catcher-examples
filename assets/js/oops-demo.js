class G{storageKey="oops-catcher-consent";consentState=null;constructor(){this.loadConsent()}loadConsent(){try{let b=localStorage.getItem(this.storageKey);this.consentState=b?JSON.parse(b):null}catch(b){console.warn("Failed to load consent:",b),this.consentState=null}}saveConsent(){if(!this.consentState)return;try{localStorage.setItem(this.storageKey,JSON.stringify(this.consentState))}catch(b){console.warn("Failed to save consent:",b)}}grantConsent(b={}){this.consentState={granted:!0,timestamp:new Date().toISOString(),preferences:{userAgent:!0,platform:!0,screenResolution:!0,viewport:!0,online:!0,cookiesEnabled:!0,pixelRatio:!0,language:b.language??!0,timezone:b.timezone??!0,memory:b.memory??!0,cores:b.cores??!0,touchSupport:b.touchSupport??!0,colorDepth:b.colorDepth??!0}},this.saveConsent()}revokeConsent(){this.consentState=null;try{localStorage.removeItem(this.storageKey)}catch(b){console.warn("Failed to remove consent:",b)}}hasConsent(){return this.consentState?.granted??!1}getConsentState(){return this.consentState}isFieldAllowed(b){if(!this.hasConsent())return!1;let j=this.consentState?.preferences;if(!j)return!1;if(["userAgent","platform","screenResolution","viewport","online","cookiesEnabled","pixelRatio"].includes(b))return!0;return j[b]??!1}}class H{config;consent;consoleErrors=[];maxConsoleErrors;constructor(b){if(this.config=b,this.maxConsoleErrors=b.maxConsoleErrors||20,this.consent=new G,b.captureConsole)this.setupConsoleCapture()}setupConsoleCapture(){let b=console.error,j=this;console.error=function(...w){b.apply(console,w);let q=w.map((F)=>typeof F==="object"?JSON.stringify(F):String(F)).join(" ");if(j.consoleErrors.push({message:q,timestamp:new Date().toISOString(),type:"error",url:window.location.href}),j.consoleErrors.length>j.maxConsoleErrors)j.consoleErrors.shift()}}getSystemInfo(){if(!this.consent.hasConsent())throw new Error("User consent required. Call grantConsent() first.");let b=navigator.userAgent,j=b.includes("Mac")&&navigator.maxTouchPoints>0,w=navigator.platform;if(j)w="macOS (Apple Silicon)";let q={userAgent:b,platform:w,screenResolution:`${window.screen.width}x${window.screen.height}`,viewport:`${window.innerWidth}x${window.innerHeight}`,online:navigator.onLine,cookiesEnabled:navigator.cookieEnabled,pixelRatio:window.devicePixelRatio};if(this.consent.isFieldAllowed("language"))q.language=navigator.language;if(this.consent.isFieldAllowed("timezone"))q.timezone=Intl.DateTimeFormat().resolvedOptions().timeZone;if(this.consent.isFieldAllowed("memory")){let F=navigator.deviceMemory;if(F)q.memory=`${F} GB`}if(this.consent.isFieldAllowed("cores"))q.cores=navigator.hardwareConcurrency;if(this.consent.isFieldAllowed("touchSupport"))q.touchSupport=navigator.maxTouchPoints>0;if(this.consent.isFieldAllowed("colorDepth"))q.colorDepth=`${window.screen.colorDepth}-bit`;return q}catch(b){let j=typeof b==="string"?b:b.message,w=typeof b==="string"?void 0:b.stack;if(this.consoleErrors.push({message:j,stack:w,timestamp:new Date().toISOString(),type:"error",url:window.location.href}),this.consoleErrors.length>this.maxConsoleErrors)this.consoleErrors.shift();return this.generateReport()}generateReport(){return{systemInfo:this.consent.hasConsent()?this.getSystemInfo():null,consoleErrors:this.consoleErrors,userId:this.config.userId,userEmail:this.config.userEmail,metadata:this.config.metadata,timestamp:new Date().toISOString()}}async report(b){let j=b.category==="bug"||b.severity!==void 0,w={userReport:b,systemInfo:j&&this.consent.hasConsent()?this.getSystemInfo():null,consoleErrors:j?this.consoleErrors:void 0,userId:this.config.userId,userEmail:this.config.userEmail,metadata:this.config.metadata,timestamp:new Date().toISOString()};return console.group("\uD83D\uDCE6 Oops.report() - Submission"),console.log("Report:",w),console.groupEnd(),await new Promise((q)=>setTimeout(q,500)),{success:!0,message:"Report submitted successfully",id:"demo-"+Date.now()}}getConsoleErrors(){return this.consoleErrors}}function L(b){return new H(b)}export{L as initOops,H as OopsDemo};

//# debugId=5A26CAB38339BBDF64756E2164756E21
