{
  "version": 3,
  "sources": ["../../src/consent-manager.ts", "../../src/oops-demo.ts"],
  "sourcesContent": [
    "/**\n * Consent Manager - Privacy-first consent management\n * Simulates the consent system from Oops Catcher SDK\n */\n\nexport interface ConsentPreferences {\n  // Required fields - always collected\n  userAgent: boolean\n  platform: boolean\n  screenResolution: boolean\n  viewport: boolean\n  online: boolean\n  cookiesEnabled: boolean\n  pixelRatio: boolean\n\n  // Optional fields - user can opt in/out\n  language?: boolean\n  timezone?: boolean\n  memory?: boolean\n  cores?: boolean\n  touchSupport?: boolean\n  colorDepth?: boolean\n}\n\nexport interface ConsentState {\n  granted: boolean\n  timestamp: string\n  preferences: ConsentPreferences\n}\n\nexport class ConsentManager {\n  private storageKey = 'oops-catcher-consent'\n  private consentState: ConsentState | null = null\n\n  constructor() {\n    this.loadConsent()\n  }\n\n  private loadConsent(): void {\n    try {\n      const stored = localStorage.getItem(this.storageKey)\n      this.consentState = stored ? JSON.parse(stored) : null\n    } catch (e) {\n      console.warn('Failed to load consent:', e)\n      this.consentState = null\n    }\n  }\n\n  private saveConsent(): void {\n    if (!this.consentState) return\n\n    try {\n      localStorage.setItem(this.storageKey, JSON.stringify(this.consentState))\n    } catch (e) {\n      console.warn('Failed to save consent:', e)\n    }\n  }\n\n  grantConsent(preferences: Partial<Omit<ConsentPreferences, 'userAgent' | 'platform' | 'screenResolution' | 'viewport' | 'online' | 'cookiesEnabled' | 'pixelRatio'>> = {}): void {\n    this.consentState = {\n      granted: true,\n      timestamp: new Date().toISOString(),\n      preferences: {\n        // Required fields - always true\n        userAgent: true,\n        platform: true,\n        screenResolution: true,\n        viewport: true,\n        online: true,\n        cookiesEnabled: true,\n        pixelRatio: true,\n        // Optional fields - default to true unless explicitly set\n        language: preferences.language ?? true,\n        timezone: preferences.timezone ?? true,\n        memory: preferences.memory ?? true,\n        cores: preferences.cores ?? true,\n        touchSupport: preferences.touchSupport ?? true,\n        colorDepth: preferences.colorDepth ?? true\n      }\n    }\n\n    this.saveConsent()\n  }\n\n  revokeConsent(): void {\n    this.consentState = null\n    try {\n      localStorage.removeItem(this.storageKey)\n    } catch (e) {\n      console.warn('Failed to remove consent:', e)\n    }\n  }\n\n  hasConsent(): boolean {\n    return this.consentState?.granted ?? false\n  }\n\n  getConsentState(): ConsentState | null {\n    return this.consentState\n  }\n\n  isFieldAllowed(field: keyof ConsentPreferences): boolean {\n    if (!this.hasConsent()) return false\n\n    const preferences = this.consentState?.preferences\n    if (!preferences) return false\n\n    // Required fields are always allowed\n    const requiredFields: (keyof ConsentPreferences)[] = [\n      'userAgent', 'platform', 'screenResolution',\n      'viewport', 'online', 'cookiesEnabled', 'pixelRatio'\n    ]\n\n    if (requiredFields.includes(field)) return true\n\n    // Optional fields - check preference\n    return preferences[field] ?? false\n  }\n}\n",
    "/**\n * Oops Demo - Simulated SDK for demonstrations\n * This simulates the actual Oops Catcher SDK for live demos\n */\n\nimport { ConsentManager } from './consent-manager'\n\nexport interface OopsConfig {\n  endpoint: string\n  apiKey?: string\n  captureConsole?: boolean\n  maxConsoleErrors?: number\n  userId?: string\n  userEmail?: string\n  metadata?: Record<string, any>\n}\n\nexport interface UserReport {\n  message: string\n  description?: string\n  category?: 'bug' | 'feedback' | 'question' | 'other'\n  severity?: 'low' | 'medium' | 'high' | 'critical'\n  screenshot?: string\n  attachments?: Array<{\n    name: string\n    url: string\n  }>\n  custom?: Record<string, any>\n}\n\nexport interface SystemInfo {\n  userAgent: string\n  platform: string\n  screenResolution: string\n  viewport: string\n  online: boolean\n  cookiesEnabled: boolean\n  pixelRatio: number\n  language?: string\n  timezone?: string\n  memory?: string\n  cores?: number\n  touchSupport?: boolean\n  colorDepth?: string\n}\n\nexport interface ConsoleError {\n  message: string\n  stack?: string\n  timestamp: string\n  type: string\n  url?: string\n}\n\nexport interface OopsReport {\n  userReport?: UserReport\n  systemInfo: SystemInfo | null\n  consoleErrors?: ConsoleError[]\n  userId?: string\n  userEmail?: string\n  metadata?: Record<string, any>\n  timestamp: string\n}\n\nexport interface OopsResponse {\n  success: boolean\n  message: string\n  id: string\n}\n\nexport class OopsDemo {\n  private config: OopsConfig\n  public consent: ConsentManager\n  private consoleErrors: ConsoleError[] = []\n  private maxConsoleErrors: number\n\n  constructor(config: OopsConfig) {\n    this.config = config\n    this.maxConsoleErrors = config.maxConsoleErrors || 20\n    this.consent = new ConsentManager()\n\n    if (config.captureConsole) {\n      this.setupConsoleCapture()\n    }\n  }\n\n  private setupConsoleCapture(): void {\n    const originalError = console.error\n    const self = this\n\n    console.error = function(...args: any[]) {\n      originalError.apply(console, args)\n\n      const message = args.map(arg =>\n        typeof arg === 'object' ? JSON.stringify(arg) : String(arg)\n      ).join(' ')\n\n      self.consoleErrors.push({\n        message,\n        timestamp: new Date().toISOString(),\n        type: 'error',\n        url: window.location.href\n      })\n\n      // Limit array size\n      if (self.consoleErrors.length > self.maxConsoleErrors) {\n        self.consoleErrors.shift()\n      }\n    }\n  }\n\n  private getSystemInfo(): SystemInfo {\n    if (!this.consent.hasConsent()) {\n      throw new Error('User consent required. Call grantConsent() first.')\n    }\n\n    const ua = navigator.userAgent\n    const isAppleSilicon = ua.includes('Mac') && navigator.maxTouchPoints > 0\n    let platformInfo = navigator.platform\n    if (isAppleSilicon) {\n      platformInfo = 'macOS (Apple Silicon)'\n    }\n\n    const systemInfo: SystemInfo = {\n      userAgent: ua,\n      platform: platformInfo,\n      screenResolution: `${window.screen.width}x${window.screen.height}`,\n      viewport: `${window.innerWidth}x${window.innerHeight}`,\n      online: navigator.onLine,\n      cookiesEnabled: navigator.cookieEnabled,\n      pixelRatio: window.devicePixelRatio\n    }\n\n    if (this.consent.isFieldAllowed('language')) {\n      systemInfo.language = navigator.language\n    }\n\n    if (this.consent.isFieldAllowed('timezone')) {\n      systemInfo.timezone = Intl.DateTimeFormat().resolvedOptions().timeZone\n    }\n\n    if (this.consent.isFieldAllowed('memory')) {\n      const memory = (navigator as any).deviceMemory\n      if (memory) systemInfo.memory = `${memory} GB`\n    }\n\n    if (this.consent.isFieldAllowed('cores')) {\n      systemInfo.cores = navigator.hardwareConcurrency\n    }\n\n    if (this.consent.isFieldAllowed('touchSupport')) {\n      systemInfo.touchSupport = navigator.maxTouchPoints > 0\n    }\n\n    if (this.consent.isFieldAllowed('colorDepth')) {\n      systemInfo.colorDepth = `${window.screen.colorDepth}-bit`\n    }\n\n    return systemInfo\n  }\n\n  public catch(error: Error | string): OopsReport {\n    const errorMessage = typeof error === 'string' ? error : error.message\n    const errorStack = typeof error === 'string' ? undefined : error.stack\n\n    this.consoleErrors.push({\n      message: errorMessage,\n      stack: errorStack,\n      timestamp: new Date().toISOString(),\n      type: 'error',\n      url: window.location.href\n    })\n\n    if (this.consoleErrors.length > this.maxConsoleErrors) {\n      this.consoleErrors.shift()\n    }\n\n    return this.generateReport()\n  }\n\n  private generateReport(): OopsReport {\n    return {\n      systemInfo: this.consent.hasConsent() ? this.getSystemInfo() : null,\n      consoleErrors: this.consoleErrors,\n      userId: this.config.userId,\n      userEmail: this.config.userEmail,\n      metadata: this.config.metadata,\n      timestamp: new Date().toISOString()\n    }\n  }\n\n  public async report(userReport: UserReport): Promise<OopsResponse> {\n    // Smart data collection - only include system info for bug reports\n    const isBugReport = userReport.category === 'bug' || userReport.severity !== undefined\n\n    const report: OopsReport = {\n      userReport,\n      systemInfo: isBugReport && this.consent.hasConsent() ? this.getSystemInfo() : null,\n      consoleErrors: isBugReport ? this.consoleErrors : undefined,\n      userId: this.config.userId,\n      userEmail: this.config.userEmail,\n      metadata: this.config.metadata,\n      timestamp: new Date().toISOString()\n    }\n\n    // Log for demo purposes\n    console.group('ðŸ“¦ Oops.report() - Submission')\n    console.log('Report:', report)\n    console.groupEnd()\n\n    // Simulate API call\n    await new Promise(resolve => setTimeout(resolve, 500))\n\n    return {\n      success: true,\n      message: 'Report submitted successfully',\n      id: 'demo-' + Date.now()\n    }\n  }\n\n  public getConsoleErrors(): ConsoleError[] {\n    return this.consoleErrors\n  }\n}\n\n// Export factory function for easy initialization\nexport function initOops(config: OopsConfig): OopsDemo {\n  return new OopsDemo(config)\n}\n"
  ],
  "mappings": "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",
  "debugId": "5A26CAB38339BBDF64756E2164756E21",
  "names": []
}